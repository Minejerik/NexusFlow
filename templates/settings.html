<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet" >
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" ></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js" integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT" crossorigin="anonymous"></script>  
	<title>NexusFlow | Settings</title>
</head>
<body>

	<script>

		async function sendsettings(){
			let name = document.getElementById("name").value;
			let bio = document.getElementById("bio").value;
			let password = document.getElementById("password").value;
			let confirm_password = document.getElementById("confirm-password").value;
			if (password != confirm_password){
				alert("Passwords do not match");
				return;
			}
			if (!password && !confirm_password) {
				password = null;
				confirm_password = null;
			}
			let data = {
				"name": name,
				"bio": bio,
				"password": password,
				"confirm_password": confirm_password
			}
			//bruh setsettings is a goofy name
			let response = await fetch("/api/setsettings", {
				method: "POST",
				headers: {
					"Content-Type": "application/json"
				},
				body: JSON.stringify(data)
			});
			let result = await response.json();
			if(result.error == false){
				alert("Settings updated successfully");
			}
			else{
				alert(result.error);
			}
		}

	</script>

	{% set user = myuser %}
	{% include "header.html" %}
    <div class="container mt-5">
		<div class="row">
		  <div class="col-md-3">
			<h3 class="mb-4">Settings</h3>
		  </div>
		  <div class="col-md-9">
			<div class="card">
			  <div class="card-body">
				<form onsubmit="sendsettings()">
					<div class="mb-3">
					  <label for="name" class="form-label">Change Username</label>
					  <input type="text" class="form-control" id="name" value="{{user.name}}">
					</div>
				  <div class="mb-3">
					<label for="email" class="form-label">Bio</label>
					<textarea class="form-control" id="bio" rows="3">{{user.bio}}</textarea>
					<!-- <input type="email" class="form-control" id="email" placeholder="Enter your email"> -->
				  </div>
				  <h4>Change Password</h4>
				  <div class="mb-3">
					<label for="password" class="form-label">Password</label>
					<input type="password" class="form-control" id="password" placeholder="Enter your password">
				  </div>
				  <div class="mb-3">
					<label for="confirm-password" class="form-label">Confirm Password</label>
					<input type="password" class="form-control" id="confirm-password" placeholder="Confirm your password">
				  </div>
				  <button type="submit" class="btn btn-primary">Save Changes</button>
				</form>
			  </div>
			</div>
		  </div>
		</div>
	  </div>
</body>
</html>